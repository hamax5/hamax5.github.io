<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" class="wf-katexmath-i4-active wf-katexmain-n4-active wf-active"><head>
    <meta charset="UTF-8">
    
    <title>µó×ë</title>

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="language" content="english">
<meta name="viewport" content="width=device-width">
  
  
<link rel="stylesheet" href="https://ktky.sakura.ne.jp/eps/lib/highlight/monokai-sublime.min.css" type="text/css">
<link rel="stylesheet" href="https://ktky.sakura.ne.jp/eps/lib/quill/quill.snow.css" type="text/css">

<style>
  body &amp;gt; .standalone-container {
      max-width: 720px;
  }
  .ql-container.ql-snow {
  border: none;
  }
  
</style>
<script src="https://ktky.sakura.ne.jp/lib/jquery/jquery-3.3.1.js"></script>
<script src="https://ktky.sakura.ne.jp/lib/algebrite/algebrite.bundle-for-browser.js"></script>

<script type="text/javascript" src="https://ktky.sakura.ne.jp/lib/highlight/highlight.min.js"></script>
<script type="text/javascript" src="https://ktky.sakura.ne.jp/lib/quill/quill.js"></script>
<script type="text/javascript" src="https://ktky.sakura.ne.jp/lib/crypto/crypto-js.min.js"></script>
<script type="text/javascript" src="https://ktky.sakura.ne.jp/lib/crypto/sha1.js"></script>

<!-- <script type="text/javascript" src="https://ktky.sakura.ne.jp/lib/eps_s.js"></script> -->
<script type="text/javascript" src="https://ktky.sakura.ne.jp/lib/eps_t2.js"></script>
<!-- <script type="text/javascript" src="eps_t2.js"></script> -->
<script type="text/javascript" src="https://ktky.sakura.ne.jp/lib/FileSaver.js"></script>

<link rel="stylesheet" href="https://ktky.sakura.ne.jp/lib/CindyJS/CindyJS.css">
<script type="text/javascript" src="https://ktky.sakura.ne.jp/lib/CindyJS/Cindy.js"></script><script src="https://ktky.sakura.ne.jp/lib/CindyJS/katex/katex.min.js"></script><script src="https://ktky.sakura.ne.jp/lib/CindyJS/webfont.js"></script><link rel="stylesheet" href="https://ktky.sakura.ne.jp/lib/CindyJS/katex/katex.min.css" media="all"><link rel="stylesheet" href="https://ktky.sakura.ne.jp/lib/CindyJS/katex/katex.min.css" media="all"><link rel="stylesheet" href="https://ktky.sakura.ne.jp/lib/CindyJS/katex/katex.min.css" media="all"><link rel="stylesheet" href="https://ktky.sakura.ne.jp/lib/CindyJS/katex/katex.min.css" media="all"><script src="https://ktky.sakura.ne.jp/lib/CindyJS/katex-plugin.js"></script>
<!--
<script src="https://ktky.sakura.ne.jp/lib/CindyJS/katex/katex.min.js">
</script><script src="https://ktky.sakura.ne.jp/lib/CindyJS/webfont.js"></script>
<link rel="stylesheet" href="https://ktky.sakura.ne.jp/lib/CindyJS/katex/katex.min.css" media="all">
-->

<script src="https://bossanova.uk/jspreadsheet/v4/jexcel.js"></script>
<link rel="stylesheet" href="https://bossanova.uk/jspreadsheet/v4/jexcel.css" type="text/css">
 
<script src="https://jsuites.net/v4/jsuites.js"></script>
<link rel="stylesheet" href="https://jsuites.net/v4/jsuites.css" type="text/css">
 
<!-- <script type="text/javascript" src="./lib/sheetjs/xlsx.full.min.js"></script> -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.2.0/chart.min.js" integrity="sha512-VMsZqo0ar06BMtg0tPsdgRADvl0kDHpTbugCBBrL55KmucH6hP9zWdLIWY//OTfMnzz6xWQRxQqsUFefwHuHyg==" crossorigin="anonymous"></script>
  
<script src="https://unpkg.com/@open-ayame/ayame-web-sdk@2020.3.0/dist/ayame.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qs/6.7.0/qs.min.js"></script>


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css" integrity="sha384-KiWOvVjnN8qwAZbuQyWDIbfCLFhLXNETzBQjA/92pIowpC0d2O3nppDGQVgwd2nB" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js" integrity="sha384-0fdwu/T/EQMsQlrHCCHoH10pkPLlKA1jL5dFyUOvB3lfeT2540/2g6YgSi2BL14p" crossorigin="anonymous"></script>

  
<script id="csdraw" type="text/x-cindyscript">csdraw();

//Script (CindyScript)

Ketinit();
Setketcindyjs(["Label=[]","Color=offwhite"]);//no ketjs

pO=[0,0];
Circledata("1",[pO,5],["dr,70","Color=black"]);
Circledata("2",[pO,4],["dr,70","Color=yellow"]);



ss=Animationparam(0,2*pi/3,2*pi);

if(ss>pi/4,
  Circledata("1",[pO,5],["dr,70","Color=yellow"]);
);
  if(ss>pi/4,
    Circledata("2",[pO,4],["dr,70","Color=black"]);
  );
if(ss>pi/2,
  Circledata("1",[pO,5],["dr,70","Color=black"]);
);
  if(ss>pi/2,
    Circledata("2",[pO,4],["dr,70","Color=yellow"]);
  );

if(ss>pi*3/4,
  Circledata("1",[pO,5],["dr,70","Color=yellow"]);
);
  if(ss>pi*3/4,
    Circledata("2",[pO,4],["dr,70","Color=black"]);
  );
if(ss>pi,
  Circledata("1",[pO,5],["dr,70","Color=black"]);
);
  if(ss>pi,
    Circledata("2",[pO,4],["dr,70","Color=yellow"]);
  );

if(ss>5/4*pi,
  Circledata("1",[pO,5],["dr,70","Color=yellow"]);
);
  if(ss>5/4*pi,
    Circledata("2",[pO,4],["dr,70","Color=black"]);
  );
if(ss>6/4*pi,
  Circledata("1",[pO,5],["dr,70","Color=black"]);
);
  if(ss>6/4*pi,
    Circledata("2",[pO,4],["dr,70","Color=yellow"]);
  );
if(ss>7/4*pi,
  Circledata("1",[pO,5],["dr,70","Color=yellow"]);
);
  if(ss>7/4*pi,
    Circledata("2",[pO,4],["dr,70","Color=black"]);
  );

Arrowdata("1",[[0,0],3.2*[sin(1*ss),cos(1*ss)]],["dr,7",7]);



Windispg();</script>
            
<script id="csmove" type="text/x-cindyscript">csmove();

//Script (CindyScript)

</script>

<script id="csinit" type="text/x-cindyscript">
       
printtextarea(textareaname,text):=(
s2 = "EPS.append_textarea('" + textareaname + "','" + text + "')";
javascript(s2);
);

printtextareaxy(textareaname,argmentp):=(
regional(text);
text="(" + argmentp.x + "," + argmentp.y + ")";
printtextarea(textareaname,text)
);

jstocs(jsvar,csvar,csname):=(
com = "EPS.js_to_cs('" + csname + "','" + jsvar + "','" + csvar +"')";
javascript(com);
);

jsstringtocs(jsvar,csvar,csname):=(
com = "EPS.jsstring_to_cs('" + csname + "','" + jsvar + "','" + csvar +"')";
javascript(com);
);

cstojs(csvar,jsvar):=(
// print("csvar="+csvar+", jsvar="+jsvar);
// print(jsvar + " = " + parse(csvar));
javascript(jsvar + " = " + parse(csvar));
);

csstringtojs(csvar,jsvar):=(
javascript(jsvar + " = '" + parse(csvar) + "'");
// javascript(jsvar + " = " + csvar);
);

exejs(argmentcom) := (
 javascript(argmentcom)
);

execs(argmentcom):=(
 parse(argmentcom);
);

gettextarea(csname,textareaname):= (
  regional(gettextareatmpvar1,gettextareatmpvar2);
  javascript("gettextareatmpvar1 = get_textarea('" + textareaname + "')");
  jstocs("gettextareatmpvar1","gettextareatmpvar2",csname);
  gettextareatmpvar2;
);

gettextareastring(csname,textareaname):= (
  regional(gettextareatmpvar1,gettextareatmpvar2);
  javascript("gettextareatmpvar1 = get_textarea('" + textareaname + "')");
  jsstringtocs("gettextareatmpvar1","gettextareatmpvar2",csname);
  gettextareatmpvar2;
);

exejstextarea(csname,textareanam):=(
  javascript("EPS.exe_cs_textarea('" + csname + "','" + textareanam + "')");
);

execstextarea(csname,textareanam):=(
  javascript("EPS.exe_cs_textarea('" + csname + "','" + textareanam + "')");
);

exejstextarea(textareanam):=(
  javascript("EPS.exe_js_textarea('" + textareanam + "')");
);

exeal(command,csname):=(
  regional(exealtmp2);
  exejs("exealtmp1=Algebrite.run('"+command+"')");
  jsstringtocs("exealtmp1","exealtmp2",csname);
  exealtmp2;
);

cleartextarea(textareaname):=(
  javascript("EPS.clear_textarea('"+textareaname+"')");
);


csdraw() := ();

prevx=0;
prevy=0;

csmove() := ();

pnum = 0;
plist = [];
pvars = [];

gammacoef=[676.5203681218851 , - 1259.1392167224028 ,771.32342877765313 , - 176.61502916214059 , 12.507343278686905 ,- 0.13857109526572012 , 9.9843695780195716*10^(-6),1.5056327351493116 * 10^(- 7)];
gamma(z0):=(
  regional(z,x,y,t);
  z = z0;
  if(z<0.5,y=pi/(sin(pi*z)*gamma(1-z)),
    z = z-1;
    x = 0.99999999999980993;
    repeat(length(gammacoef),x=x+(gammacoef_#)/(z+#));
    t = z + length(gammacoef)-0.5;
    y = sqrt(2*pi)*t^(z+0.5)*exp(-t)*x;
  );
  y;
);

beta(a,b):=gamma(a)*gamma(b)/gamma(a+b);

incbeta(x,a,b):=(
  regional(eps,c1,u1,u2,v1,v2,g0,g1,g2,n,n2,n2a,c0,c1,u0,v0,v1,v2,y);
  eps = 10^(-8);
  c1 = - x * (a + b) / (a + 1);
  u1 = 2;
  u2 = 1 + c1 / u1;
  v1 = 1;
  v2 = 1 + c1 / v1;
  g0 = 1;
  g1 = u1 / v1 * g0;
  g2 = u2 / v2 * g1;
  n = 1;
  while((abs(g2-g0)>eps)&(n<1000),
    n2 = n * 2;
    n2a = n2 + a;
    c0 = x * n * (b - n) / (n2a * (n2a - 1));
    c1 = - x * (a + n) * (a + b + n) / (n2a * (n2a + 1));
    u0 = u2;
    u1 = 1 + c0 / u0;
    u2 = 1 + c1 / u1;
    v0 = v2;
    v1 = 1 + c0 / v0;
    v2 = 1 + c1 / v1;
    g0 = g2;
    g1 = u1 / v1 * g0;
    g2 = u2 / v2 * g1;
    n = n+1
  );
  if(n>=1000,println("ERROR incbeta do NOT converge!!!"));
  y = (x^a) * ((1 - x)^b) * (g2 - 1) / a;
);


regincbeta(x,a,b):=incbeta(x,a,b)/beta(a,b);

tpd(nu,x):=gamma((nu+1)/2)/(sqrt(nu*pi)*gamma(nu/2))*(1+x^2/nu)^(-(nu+1)/2);

tcd(nu,x):=regincbeta((x+sqrt(x^2+nu))/(2*sqrt(x^2+nu)),nu/2,nu/2);

tcdt(nu,x):=(
  regional(x2,result);
  x2 = x^2;
  if(100*x2<nu,result=1-regincbeta(x2/(x2+nu),1/2,nu/2),result=regincbeta(nu/(x2+nu),nu/2,1/2));
  result
);


invtcd(nu,y):=(
  regional(x0,x1,i,eps,n,maxloop);
  eps = 10^(-8);
  maxloop = 30;
  x0 = (20/9)*(y-0.5);
  x1 = x0-(tcd(nu,x0)-y)/tpd(nu,x0);
  n = 1;
  while((abs(x0-x1)>eps)&(n<maxloop),
    x0 = x1;
    x1 = x0-(tcd(nu,x0)-y)/tpd(nu,x0);
    n = n+1;
  );
  if(n>=maxloop,println("ERROR: invtcd do NOT converge !!!"));
  x1
);



//Script (CindyScript)



Invert(x):=reverse(x);
Ketinit():=Ketinit("fig",0.3); //190831from
Ketinit(Arg):=(//181001from
  if(isstring(Arg),
    Ketinit(Arg,0.3);
  ,
    Ketinit("fig",Arg);
  );
);
Ketinit(work,strictsep):=( //200509
 regional(pt,tmp,tmp1,tmp2,letterc,boxc,shadowc,mboxc);
  PenThickInit=8;
  ULEN="1cm";
  MEMORI=0.05;//18.01.15from
  MEMORIInit=MEMORI;
  MEMORINow=MEMORI;
  MARKLEN=0.05;
  MARKLENInit=MARKLEN; //180504
  MARKLENNow= MARKLEN;
  GENTEN=[0,0];//18.01.15to
  TABLECOUNT=0; //190428
  KETPICLAYER=20;
  MilliIn=1/2.54*1000;
  PenThick=round(MilliIn*0.02);
  PenThickInit=PenThick;
  TenSizeInit=0.02;
  TenSize=TenSizeInit;
  YaSize=1; YaAngle=18; YaPosition=1;
  YaCut=0.2; //191203
  YasenStyle="dr,1"; Yajiristyle="tf";
  KETPICCOUNT=1;
  KCOLOR=[0,0,0,1]; //200513,200618
  GLIST=[]; //201005rechanged
  GCLIST=[]; //201005rechanged
  AddGraphList=[]; //210422[2lines]
  PointDataList=[];
  if(!islist(VLISTadd),VLIST=[],VLIST=VLISTadd); //200123
  if(!islist(FUNLISTadd),FUNLIST=[],FUNLIST=FUNLISTadd); //200123
  LETTERlist=[];
  ADDAXES="1";
  AXSTYLE=[["l","x","e","y","n","O","sw","","",""],[]]; //190901
  AXCOUNT=1; //181215
  SHADECTR=1; //190222
  LFmark=unicode("000a"); Bs=unicode("005c");
  CRmark=unicode("000d");//16.12.13
  Dq=unicode("0022");
  Changework(Dircdy+pathsep()+work); //180329to,181001
  ArrowlineNumber=1;  // 15.01.05
  ArrowheadNumber=1;
  BezierNumber=1; //15.01.03
  SCALEX=1;
  SCALEY=1;
  XMIN=-5;
  XMAX=5;
  YMIN=-5;
  YMAX=5;
  StrictSep=strictsep; //190831
  Setwindow("Msg=n"); // 16.05.31
  forall(remove(allpoints(),[SW,NE]),
    Strictmove(#.name);
    Ptpos(#,#.xy); //200529
  ); //190917
);
Setwindow():=Setwindow("Msg=y");
Setwindow(str):=(
  regional(tmp,tmp1,tmp2,msg);
  msg="Y";
  tmp=indexof(str,"="); // 16.02.10
  msg=Toupper(substring(str,tmp,tmp+1));
  Strictmove("SW"); Strictmove("NE");//190927
  if((ispoint(SW)) & (ispoint(NE)),
    tmp1=LLcrd(Ptpos(SW));//190912[2lines]
    tmp2=LLcrd(Ptpos(NE));
    XMIN=tmp1_1; XMAX=tmp2_1;
    YMIN=tmp1_2; YMAX=tmp2_2;
  ,
    if(!ispoint(SW), //191005from
      Putpoint("SW",Pcrd([-5,-5]));
      XMIN=-5; YMIN=-5;
      Ptpos(SW,SW.xy);
    );
    if(!ispoint(NE),
      Putpoint("NE", Pcrd([5,5]));
      XMAX=5; YMAX=5;
      Ptpos(NE,NE.xy);
    ); //191005to
  );
);
Setwindow(xrange,yrange):=Setwindow(xrange,yrange,"Msg=y");
Setwindow(xrange,yrange,msg):=(
  XMIN=xrange_1;
  XMAX=xrange_2;
  YMIN=yrange_1;
  YMAX=yrange_2;
  Ptpos(SW,Pcrd([XMIN,YMIN])); //190927from
  Ptpos(NE,Pcrd([XMAX,YMAX]));
  Strictmove("SW"); Strictmove("NE");
);
Toupper(str):=(
  regional(alphabet,out,tmp,tmp1);
  alphabet="abcdefghijklmnopqrstuvwxyz";
  out="";
  forall(1..(length(str)),
    tmp=substring(str,#-1,#);
    tmp1=indexof(alphabet,tmp);
    if(tmp1>0,
      out=out+unicode(text(tmp1+64),base->10);
    ,
      out=out+tmp;
    );
  );
  out;
);
LLcrd(pt):=(
  regional(tmp);
  if(ispoint(pt),
    tmp=pt.xy
  ,
    tmp=pt;
  );
  tmp=[tmp_1/SCALEX,tmp_2/SCALEY];
  re(tmp); //191231
);
Putpoint(name,Pt):=Putpoint(name,Pt,Pt);
Putpoint(name,Ptinit,Pt):=(
  regional(ptstr); 
    ptstr=name+".xy="+Textformat(Pcrd(Pt),10)+";";
    parse(ptstr);
    Ptpos(name,Pcrd([Pt_1,Pt_2])); //200529
);
Textformat(value,dig):=(
  regional(vv,tmp,tmp1);
  if(islist(value),
    tmp1="[";
    forall(value,
      tmp1=tmp1+Textformat(#,dig)+",";
    );
    if(length(tmp1)>1, //18.01.29from
      tmp1=substring(tmp1,0,length(tmp1)-1);
    );
    tmp1=tmp1+"]"; //18.01.29until
  ,
    if(ispoint(value) % isstring(value),
      if(isstring(value),tmp1=Dq+value+Dq,tmp1=text(value)); // 15.10.02
    ,
      tmp1=format(value,dig);
    );
  );
  tmp1;
);
Ptpos(pt):=Ptpos(pt,[]);
Ptpos(ptorg,pos):=(
  regional(pt,out,tmp);
  if(ispoint(ptorg),pt=ptorg,pt=parse(ptorg));
  if(length(pos)==0,
    tmp=pt.name+"position";
    out=parse(tmp);
    if(!islist(out),
      tmp=tmp+"="+Textformat(pt.xy,12)+";";  //200108 6->12
      parse(tmp);
    );
  ,
    pt.xy=pos;
    tmp=pt.name+"position="+Textformat(pt.xy,12)+";"; //200108 6->12
    parse(tmp);
    out=pt.xy;
  );
  out;
);
Pcrd(pt):=(
  regional(tmp);
  if(ispoint(pt),
    tmp=pt.xy;
  ,
    tmp=[pt_1*SCALEX,pt_2*SCALEY];
  );
 re(tmp); //191231
);
Strictmove(pC):=Strictmove(pC,StrictSep); //190831
Strictmove(pCorg,sep):=(
  regional(pC,tmp,tmp1,tmp2);
  pC=pCorg;
  if(ispoint(pC),pC=pC.name);
  tmp1=pC+"position";
  if(!islist(parse(tmp1)),
    tmp=tmp1+"="+Textformat(parse(pC).xy,12)+";"; //200112
    parse(tmp);
  ,
   tmp=parse(pC).xy;
    tmp2=mouse().xy;
    if(|tmp-tmp2|>sep,
      tmp=pC+".xy="+pC+"position";
      parse(pC).xy=parse(pC+"position");
    ,
      tmp=tmp1+"="+Textformat(parse(pC).xy,12)+";"; //200112
      parse(tmp);
    );
  );
);
Circledata(cenrad):=Circledata(cenrad,[]);
Circledata(para1,para2):=(
  regional(name,cenrad,options,str,n); 
  if(isstring(para1), 
    name=para1;
    cenrad=para2;
    options=[];
    ,
    cenrad=para1;
    options=para2;
    name="";// 16.10.07from
    forall(cenrad, 
       name=name+#.name;
    );// 16.10.07until
  );
  Circledata(name,cenrad,options);
);
Circledata(nm,cenrad,options):=(
  regional(name,Out,Ctr,Ptcir,ra,Num,Rg,opstr,opcindy,color,color4,Msg,
      tmp,tmp1,tmp2,Th,Ltype,Noflg,eqL,pA,pB,pC,d1,d2,Eps);  
  name="cr"+nm;
  tmp=Divoptions(options);
  Ltype=tmp_1;
  Noflg=tmp_2;
  eqL=tmp_5;
  color=tmp_(length(tmp)-2); color4=Colorrgb2cmyk(color); //200618
  opstr=tmp_(length(tmp)-1);
  opcindy=tmp_(length(tmp));
  Num=50;
  Rg=[0,2*pi];
  Msg="Y";
 Msg="N"; //
  forall(eqL,
    tmp=Strsplit(#,"=");
    tmp1=Toupper(substring(tmp_1,0,1));
    if(substring(#,0,1)=="N",
      Num=parse(tmp_2);
     opstr=opstr+",'"+#+"'";
    );
    if(substring(#,0,1)=="R",
      Rg=parse(tmp_2);
      opstr=opstr+",'"+#+"'";
    );
    if(tmp1=="M", //190206from
      Msg=Toupper(substring(tmp_2,0,1));
    ); //190206to
  );
  if(length(cenrad)==2,
    Ctr=Lcrd(cenrad_1);
    Ptcir=Lcrd(cenrad_2);
    if(!islist(Ptcir),  //190323from
      Ptcir=Ctr+[Ptcir,0];
    );  //190323to
    ra=dist(Ctr,Ptcir);
  ,
    Eps=10^(-1);
    pA=Lcrd(cenrad_1);
    pB=Lcrd(cenrad_2);
    pC=Lcrd(cenrad_3);
    tmp=pB-pA;
    tmp1=(tmp_2,-tmp_1);
    tmp=pC-pB;
    tmp2=(tmp_2,-tmp_1);
    d1=det([tmp1,tmp2]);
    d2=det([pC-pA,tmp2]);
    if(abs(d1)<Eps & abs(d2)>10*Eps,
      println("points are in a line");
      ra=0;
    ,
      Ctr=1/2*(pA+pB)+1/2*d2/d1*tmp1;
      ra=|pA-Ctr|;
      tmp=name+"center="+Textformat(Ctr,5)+";";
      parse(tmp);
    );
  );
  if(ra>0,
    Out=[];
    forall(0..Num,
      Th=Rg_1+#*(Rg_2-Rg_1)/Num;
      Out=append(Out,Ctr+ra*[cos(Th),sin(Th)]);
    );
  ,
    tmp=100/dist(pA,pB)*(pB-pA);
    Out=Listplot("1",[pA-tmp,pB+tmp],["nodata"]);
  );
  if(Noflg<3,
    if(Msg=="Y", //190206
      println("generate Circledata "+name);
    );
    tmp1=apply(Out,Pcrd(#));
    tmp=name+"="+Textformat(tmp1,10)+";"; //190415,210311
    parse(tmp);
  );
  if(Noflg<3, //190818
    if(isstring(Ltype),
      Ltype=Getlinestyle(text(Noflg)+Ltype,name);
    ,
      if(Noflg==1,Ltype=0);
    );
    GCLIST=append(GCLIST,[name,Ltype,opcindy]);
  );
  Out;
);
Divoptions(options):=(
  regional(Ltype,Noflg,Inflg,Outflg,eqL,realL,strL,
      color,opstr,opcindy,flg,tmp,tmp1,tmp2);
  Ltype="dr";  // 2015.01.13
  Noflg=0;
  Inflg=0;
  Outflg=0;
  eqL=[];
  realL=[];
  strL=[];
  color=Colorcmyk2rgb(KCOLOR); //200513
  opstr="";
  opcindy="";
  forall(options,
    flg=0;
    if(flg==0,
      if(isreal(#) % ispoint(#) % islist(#),
        realL=append(realL,#);
        opstr=opstr+","+text(#);
        flg=1;
      );
    );
    if(flg==0,
      if(indexof(#,"=")>0,
        tmp=Strsplit(#,"="); //180602from
        tmp1=Toupper(tmp_1);
        tmp2=tmp_2;
        if(tmp1=="COLOR",
          if(indexof(tmp2,"[")>0, //180928
            tmp1=parse(tmp2);
            color=tmp1;
            if(length(tmp1)==4,
              tmp1=Colorcmyk2rgb(tmp1);
            );
          ,
            color=Colorname2cmyk(tmp2);//200425
            tmp1=Colorcmyk2rgb(color); ;//200425
          );
          tmp="color->"+text(tmp1);
          opcindy=opcindy+","+tmp;
        ,
          eqL=append(eqL,#);
        );//180602to
        flg=1; 
      );
    );
    if(flg==0,
      if(indexof(#,"no")+indexof(#,"No")>0,
        if(indexof(#,"tex")>0,Noflg=1);
        if(indexof(#,"disp")>0,Noflg=2);
        if(indexof(#,"data")>0,Noflg=3);
        flg=1;
      );
    );
    if(flg==0,
      if(indexof(#,"->")>0,
        opcindy=opcindy+","+#;
        flg=1; 
      );
    );
    if(flg==0,
      if(indexof(#,"out")+indexof(#,"Out")>0,
        if(indexof(#,"-")==0,
          Outflg=1;
        ,
          Outflg=2;
        );
        flg=1;
      );
    );
    if(flg==0,
      if(indexof(#,"in")+indexof(#,"In")>0,
        if(indexof(#,"-")==0,
          Inflg=1;
        ,
          Inflg=2;
        );
        flg=1;
      );
    );
    if(flg==0,
      tmp=substring(#,0,2);
      tmp1=indexof(tmp,"dr")+indexof(tmp,"Dr");
      tmp1=tmp1+indexof(tmp,"da")+indexof(tmp,"Da");
      tmp1=tmp1+indexof(tmp,"id")+indexof(tmp,"Id");
      tmp1=tmp1+indexof(tmp,"do")+indexof(tmp,"Do");
      tmp1=tmp1+indexof(tmp,"dp")+indexof(tmp,"Dp");
      if(tmp1>0,
        Ltype=#;
        flg=1;
      );
      if(flg==0,
        if(length(#)>0, //180408
          strL=append(strL,#);
          opstr=opstr+","+Dq+#+Dq;
        );
      );
    );
  );
  if(indexof(opcindy,"color->")==0,// 16.10.07from
    tmp=Colorcmyk2rgb(KCOLOR); //200513[2lines]
    opcindy=opcindy+",color->"+text(tmp);
  );
  [Ltype,Noflg,Inflg,Outflg,eqL,realL,strL,color,opstr,opcindy];
);
Strsplit(strorg,key):=( // 210422 renewed
  regional(str,ctr,tmp,tmp1,out);
  str=strorg+key; 
  out=[];
  tmp=indexof(str,key);
  while(tmp>0,
    tmp1=substring(str,0,tmp-1);
    out=append(out,tmp1);
    str=substring(str,tmp-1+length(key),length(str));
    tmp=indexof(str,key);
  );
  out;
);
Colorname2cmyk(name):=( //181212
  regional(dL,code,tmp);
  dL=[
    ["greenyellow",[0.15,0,0.69,0]],["yellow",[0,0,1,0]],
    ["goldenrod",[0,0.1,0.84,0]],["dandelion",[0,0.29,0.84,0]],
    ["apricot",[0,0.32,0.52,0]],["peach",[0,0.5,0.7,0]],
    ["melon",[0,0.46,0.5,0]],["yelloworange",[0,0.42,1,0]],
    ["orange",[0,0.61,0.87,0]],["burntorange",[0,0.51,1,0]],
    ["bittersweet",[0,0.75,1,0.24]],["redorange",[0,0.77,0.87,0]],
    ["mahogany",[0,0.85,0.87,0.35]],["maroon",[0,0.87,0.68,0.32]],
    ["brickred",[0,0.89,0.94,0.28]],["red",[0,1,1,0]],
    ["orangered",[0,1,0.5,0]],["rubinered",[0,1,0.13,0]],
    ["wildstrawberry",[0,0.96,0.39,0]],["salmon",[0,0.53,0.38,0]],
    ["carnationpink",[0,0.63,0,0]],["magenta",[0,1,0,0]],
    ["violetred",[0,0.81,0,0]],["rhodamine",[0,0.82,0,0]],
    ["mulberry",[0.34,0.9,0,0.02]],["redviolet",[0.07,0.9,0,0.34]],
    ["fuchsia",[0.47,0.91,0,0.08]],["lavender",[0,0.48,0,0]],
    ["thistle",[0.12,0.59,0,0]],["orchid",[0.32,0.64,0,0]],
    ["darkorchid",[0.4,0.8,0.2,0]],["purple",[0.45,0.86,0,0]],
    ["plum",[0.5,1,0,0]],["violet",[0.79,0.88,0,0]],
    ["royalpurple",[0.75,0.9,0,0]],["blueviolet",[0.86,0.91,0,0.04]],
    ["periwinkle",[0.57,0.55,0,0]], ["cadetblue",[0.62,0.57,0.23,0]],
    ["cornflowerblue",[0.65,0.13,0,0]],
    ["midnightblue",[0.98,0.13,0,0.43]],
    ["navyblue",[0.94,0.54,0,0]],["royalblue",[1,0.5,0,0]],
    ["blue",[1,1,0,0]],["cerulean",[0.94,0.11,0,0]],
    ["cyan",[1,0,0,0]],["processblue",[0.96,0,0,0]],
    ["skyblue",[0.62,0,0.12,0]],["turquoise",[0.85,0,0.2,0]],
    ["tealblue",[0.86,0,0.34,0.02]],["aquamarine",[0.82,0,0.3,0]],
    ["bluegreen",[0.85,0,0.33,0]],["emerald",[1,0,0.5,0]],
    ["junglegreen",[0.99,0,0.52,0]],["seagreen",[0.69,0,0.5,0]],
    ["green",[1,0,1,0]],["forestgreen",[0.91,0,0.88,0.12]],
    ["pinegreen",[0.92,0,0.59,0.25]],["limegreen",[0.5,0,1,0]],
    ["yellowgreen",[0.44,0,0.74,0]],["springgreen",[0.26,0,0.76,0]],
    ["olivegreen",[0.64,0,0.95,0.4]],["rawsienna",[0,0.72,1,0.45]],
    ["sepia",[0,0.83,1,0.7]],["brown",[0,0.81,1,0.6]],
    ["tan",[0.14,0.42,0.56,0]],["gray",[0,0,0,0.5]],
    ["lightgray",[0,0,0,0.15]], //190429,0809
    ["cindycolor",[0.125,0.083,0,0.247]], //201027
    ["black",[0,0,0,1]],["white",[0,0,0,0]],
    ["offwhite",[0,0,0,0.03]] //190809
  ];
  tmp=select(dL,#_1==name);
  if(length(tmp)>0,
    tmp=tmp_1;
    code=tmp_2;
  ,
    println("    "+name+" not found");
    code=Assign(name); //190323
  );
);
Assign(str):=( //190125from
  regional(tmp);
  tmp=[];
  forall(VLIST,tmp=concat(tmp,[#_1,#_2]));
  Assign(str,tmp);
); //190125to
Assign(funstr,vrL):=Assign(funstr,vrL,6);
Assign(funstr,Arg1,Arg2):=( //190813from
  regional(vrL,precise,nn,out,tmp);
  if(islist(Arg1),
    vrL=Arg1; precise=Arg2;
    nn=length(vrL)/2;
    out=funstr;
    forall(1..nn,
      out=Assign(out,vrL_(2*#-1),vrL_(2*#),precise);
    );
  , 
    out=Assign(funstr,Arg1,Arg2,6);
  );
  out;
); //190813to
Assign(funstr,varname,rep,precision):=(
  regional(repstr,ii,jj,tmp,tmp1,tmp2,Notvar,Flg);
  if(isstring(rep),repstr=rep,repstr="("+Textformat(rep,precise)+")"); //190811to
  tmp=[46];  // 12.20
  tmp=concat(tmp,48..57);
  tmp=concat(tmp,65..90);
  tmp=concat(tmp,97..122);
  Notvar=apply(tmp,unicode(text(#),base->10));
  tmp2="";
  forall(1..100,
    ii=indexof(funstr,varname);
    if(ii>0,
      Flg=0;
      if(ii>1,
        tmp=substring(funstr,ii-2,ii-1);
        if(contains(Notvar,tmp),
          tmp2=tmp2+substring(funstr,0,ii);
          funstr=substring(funstr,ii,length(funstr));
          Flg=1;
        );
      );
      if(Flg==0,
        jj=ii-1+length(varname);
        if(jj<length(funstr),
          tmp=substring(funstr,jj,jj+1));
          if(contains(Notvar,tmp),
          tmp2=tmp2+substring(funstr,0,jj);
          funstr=substring(funstr,jj,length(funstr));
          Flg=1;
        );
      );
      if(Flg==0,
        tmp2=tmp2+substring(funstr,0,ii-1)+repstr;
        funstr=substring(funstr,jj,length(funstr));
      );
    );
  );
  funstr=tmp2+funstr;
  funstr;
);
Colorcmyk2rgb(clr):=(
  regional(clrnew,tmp,black);
  if(length(clr)==4,  //200618
    black=clr_4;
    tmp=apply(clr,1-min(1,#*(1-black)+black));
    clrnew=tmp_(1..3);
  ,
    clrnew=clr;  //200618
  );
  clrnew;
);
Colorrgb2cmyk(clr):=(
  regional(clrnew,tmp,black);
  if(length(clr)==3, //200618
    tmp=apply(clr,1-#);
    black=min(tmp);
    if(black!=1, //181112from
      tmp=apply(clr,(1-#-black)/(1-black));
      clrnew=append(tmp,black);
    ,
      clrnew=[0,0,0,1];  //200618
    ); //181112to
  ,
    clrnew=clr;
  );
  clrnew;
);
Lcrd(pt):=(
  regional(tmp);
  if(ispoint(pt),
    tmp=[pt.x/SCALEX,pt.y/SCALEY];
  ,
    tmp=pt;
  );
  re(tmp); //191231
);
Listplot(list):=Listplot(list,[]);
Listplot(Arg1,Arg2):=(
  regional(name,list,options,str);
  if(isstring(Arg1),
    name=Arg1;
    list=Arg2;
    Listplot(name,list,[]);
  ,
    list=Arg1;
    options=Arg2;
    name="";
    forall(list, // 16.10.07from
       name=name+#.name;
    );// 16.10.07until
    Listplot(name,list,options);
  );
);
Listplot(nm,list,options):=(
  regional(name,cutend,tmp,tmp1,tmp2,ptlist,Ltype,opcindy,Noflg,eqL,Msg,color,color4);
  if(substring(nm,0,1)=="-",  // 16.01.27 from
    name=substring(nm,1,length(nm));
  ,
    name="sg"+nm;
  ); // upto
  tmp=Divoptions(options);
  Ltype=tmp_1;
  Noflg=tmp_2;
  eqL=tmp_5;
  color=tmp_(length(tmp)-2); color4=Colorrgb2cmyk(color); //200618
  opcindy=tmp_(length(tmp));
  Msg="Y";  //190206
 Msg="N"; //
  cutend=[0,0];//180719
  forall(eqL,
    tmp=Strsplit(#,"=");
    tmp1=Toupper(substring(tmp_1,0,1));
    if(tmp1=="M",
      Msg=Toupper(substring(tmp_2,0,1));
    );
    if(tmp1=="C",//180719from
      tmp2=replace(tmp_2,"[","");
      tmp2=replace(tmp2,"]","");
      cutend=tokenize(tmp2,",");
      if(length(cutend)==1,cutend=[cutend_1,cutend_1]);     
    );//180719to
  );
  if(Noflg<3,
    if(Msg=="Y", //190206
      println("generate Listplot "+name);
    );
    if(isstring(list_1),tmp=apply(list,parse(#)),tmp=list); // 15.03.24
    ptlist=apply(tmp,Pcrd(#));
    if(|cutend|>0,//180719from
      tmp=ptlist_(length(ptlist))-ptlist_1;
      tmp=tmp/|tmp|;
      ptlist_1=ptlist_1+tmp*cutend_1;
      ptlist_(length(ptlist))=ptlist_(length(ptlist))-tmp*cutend_2;
    );//180719to
    tmp=name+"="+Textformat(ptlist,5)+";"; //190415
    parse(tmp);
  );
  if(Noflg<3, //190818
    if(isstring(Ltype),
      Ltype=Getlinestyle(text(Noflg)+Ltype,name);
    ,
      if(Noflg==1,Ltype=0);
    );
    GCLIST=append(GCLIST,[name,Ltype,opcindy]);
  );
  tmp1=apply(list,Lcrd(#));
  tmp1;
);
Getlinestyle(str,name):=(
  regional(noflg,tmp,tmp1,tmp2,Dop,Ltype,subflg);
  Ltype=-1;
  Dop="";
  tmp1=indexof(str,",");
  if(tmp1>0,
    Dop=","+substring(str,tmp1,length(str));
  );
  noflg=parse(substring(str,0,1));
  if(substring(name,0,3)=="sub",subflg=1,subflg=0);  // 16.02.29
  if(noflg<=1, //1900818from
    tmp1=Toupper(substring(str,1,3));
  ,
    tmp1="NO";
  ); //1900818to
  tmp2=""; //190119from
  tmp=indexof(str,",");
  if(tmp>0,
    tmp2=substring(str,tmp,length(str));
  ); //190119to
  if(tmp1=="DR",
    if(length(tmp2)==0,tmp2="1"); //190125
    Ltype=[0,tmp2];  //190119
    if(noflg==0 & subflg==0, // 16.02.29
    );
  );
  if(tmp1=="DA",
    if(length(tmp2)==0,tmp2="1,1"); //190125
    if(indexof(tmp2,",")==0,tmp2=tmp2+",1"); //200911
    Ltype=[1,tmp2];  //190119
    if(noflg==0 & subflg==0, // 16.02.29
    );
  );
  if(tmp1=="ID",
    if(length(tmp2)==0,tmp2="1,1"); //190125
    if(indexof(tmp2,",")==0,tmp2=tmp2+",1"); //200911
    Ltype=[2,tmp2];  //190119
    if(noflg==0 & subflg==0, // 16.02.29
    );
  );
  if(tmp1=="DO",
    if(length(tmp2)==0,tmp2="1,1"); //190125
    if(indexof(tmp2,",")==0,tmp2=tmp2+",1"); //200911
    Ltype=[3,tmp2];  //190119
    if(noflg==0 & subflg==0, // 16.02.29
    );
  );
  if(tmp1=="DP",
    if(length(tmp2)==0,tmp2="1"); //190125
    Ltype=[0,tmp2];  //190119
    tmp1=parse(name);
    tmp2="";
    forall(tmp1,
      tmp2=tmp2+Textformat(#_1,5)+",";
    );
    tmp2=substring(tmp2,0,length(tmp2)-1);
    if(noflg==0,
    );
  );
  if(tmp1=="NO", //190818from
    Ltype=[-1,"0"];
  );  //190818to
  Ltype;
);
Animationparam(start,ratio,stop):=( //190524
  regional(rng);
  if(islist(stop),rng=stop,rng=[start,stop]);
  if(isreal(Animeflg),
    if(Animeflg==1,
      sstart=Dirflg*ratio*seconds()+sorg;
    );
  ,
    Current=start;
    sstart=start;
  );
  if((sstart<=rng_1)%(sstart>=rng_2), //190528
    if(sstart<=rng_1,sstart=rng_1, sstart=rng_2); //190528
    stopanimation();
  );
  sstart;
);
Arrowdata(ptlist):=Arrowdataseg(ptlist);
Arrowdata(Arg1,Arg2):=Arrowdataseg(Arg1,Arg2);
Arrowdata(nm,ptlistorg,optionsorg):=(
  Arrowdataseg(nm,ptlistorg,optionsorg);
);
Arrowdataseg(ptlist):=Arrowdataseg(ptlist,[]); //181110from
Arrowdataseg(Arg1,Arg2):=(
  regional(name);
  if(isstring(Arg1),
    Arrowdataseg(Arg1,Arg2,[]);
  ,
    name="";
    forall(Arg1,
      if(ispoint(#),
        name=name+#.name; //190505
      );
    );
    Arrowdataseg(name,Arg1,Arg2);
  );
);  //181110from
Arrowdataseg(nm,ptlistorg,optionsorg):=(
  regional(options,Ltype,Noflg,opstr,opcindy,eqL,reL,strL,color,size,lineflg,
      flg,cutend,tmp,tmp1,tmp2,pA,pB,pC,angle,segpos,cut,scaley,Ev,Nv,pP,ptlist);
  scaley=SCALEY; //190412
  SCALEY=1; //200114
  ptlist=[];
  forall(ptlistorg,
    if(ispoint(#),tmp=[#.x, #.y], tmp=[#_1,scaley*#_2]);
    ptlist=append(ptlist,tmp);
  );
  pA=ptlist_1; pB=ptlist_2;
  options=optionsorg;
  tmp=Divoptions(options);
  Ltype=tmp_1;
  Noflg=tmp_2;
  eqL=tmp_5;
  reL=tmp_6;
  strL=tmp_7;
  color=tmp_(length(tmp)-2);
  opstr=tmp_(length(tmp)-1);
  opcindy=tmp_(length(tmp));
  size=0.2*YaSize*1/2.54*1000/MilliIn; 
  angle=YaAngle*pi/180;
  segpos=YaPosition;
  cut=YaCut;
  if(length(reL)>=1,
    size=0.2*reL_1*1/2.54*1000/MilliIn; 
  );
  if(length(reL)>=2,
    if(reL_2<2.5,angle=reL_2*YaAngle,angle=reL_2);
    angle=angle*pi/180;
  );
  if(length(reL)>=3,
    segpos=reL_3;
  );
  if(length(reL)>=4,
    cut=reL_4;
  );
  options=remove(options,reL); //191202
  cutend=[0,0];//180719
  lineflg=0;
  forall(eqL,
    tmp=Strsplit(#,"=");
    tmp1=Toupper(substring(tmp_1,0,2));
    tmp2=tmp_2;
    if(tmp1=="CU",//180719from
      tmp2=replace(tmp2,"[","");
      tmp2=replace(tmp2,"]","");
      cutend=tokenize(tmp2,",");
      if(length(cutend)==1,cutend=[cutend_1,cutend_1]);
    );
    if(tmp1=="LI",//190504from
      tmp2=Toupper(substring(tmp2,0,1));
      if(tmp2=="Y",lineflg=1);
    );//190504to
  );
  tmp=pB-pA;
  tmp=tmp/|tmp|;
  pA=ptlist_1+tmp*cutend_1;
  pB=ptlist_2-tmp*cutend_2;
  pP=pA+segpos*(pB-pA);
  Ev=-1/|pB-pA|*(pB-pA); Nv=[-Ev_2, Ev_1];
  tmp1=pP+size*cos(angle)*Ev+size*sin(angle)*Nv;
  tmp2=pP+size*cos(angle)*Ev-size*sin(angle)*Nv;
  pC=pP+(1-cut)*((tmp1+tmp2)/2-pP);
  ArrowheadNumber=ArrowheadNumber+1;
  if(Noflg<2,
    if(lineflg==1,
      Listplot("-ar"+nm+"h",[tmp1,pP,tmp2],append(options,"Msg=n")); //210522
    ,
      Listplot("-ar"+nm+"h",[tmp1,pP,tmp2,pC,tmp1],["dr,0.1","Color="+color,"Msg=n"]); //210522
tmp=Colorcmyk2rgb(color); // 
fillpoly(parse("ar"+nm+"h"),color->tmp); // 
    );
    if(lineflg==0,
      if(segpos==1,pB=pC); //191202
    );
    Listplot("-ar"+nm,[pA,pB],[Ltype,"Color="+color,"Msg=n"]); 
  );
  SCALEY=scaley; //200114
  [LLcrd(pA),LLcrd(pB)];
);
Windispg():=(
  if(ADDAXES=="1", //181215from
    Drwxy();
    ADDAXES="0";
  ); //181215to
  Windispg(GCLIST); //190125
);
Windispg(gcLorg):=( //190125
  regional(gcL,Nj,Nk,Dt,Vj,tmp,tmp1,tmp2,tmp3,tmp4,typeL,opcindy,flg);
  gcL=gcLorg; //190125from
  if(length(gcL)>0,
    if(!islist(gcL_1),gcL=[gcL]);
  ); //190125to
  gcL=select(gcL,#_2_1>=0); //190818
  gsave();
  layer(KETPIClAYER); // 210602[spell]
  forall(gcL,Nj,
    flg=0;
    if(isstring(Nj_1),
      if(Nj_2_1>4, //200716from
        parse(Nj_1);
        flg=1; 
      ,
        Dt=parse(Nj_1);
      );  //200716to
    ,
      Dt=Nj_1
    );  // 11.17
    if((flg==0)&(islist(Dt))&(length(Dt)>0),  // 12.19,12.22,200716
      tmp=Measuredepth(Dt);
      if(tmp==1,Dt=[Dt]);
      opcindy=Nj_3;
      typeL=Nj_2; //200620from
      if(isstring(typeL_2),tmp=tokenize(typeL_2,","),tmp=[typeL_2]); //200623
      typeL=prepend(typeL_1,tmp); //200620from
      if(typeL_1<0,typeL_1=0);
      tmp1=typeL_1;
      if(tmp1<10,
        forall(Dt,Nk,
          if(length(Nk)>1,
            tmp3="";
            if(indexof(opcindy,"color")==0, //190122from
              tmp=Colorcmyk2rgb(KCOLOR); //200513[2lines]
              tmp3=tmp3+",linecolor->"+text(tmp);
            );
            tmp3=tmp3+opcindy;
            if(tmp1==0,  //190126from
              if(indexof(opcindy,"size")==0, 
                tmp3=tmp3+",size->"+text(typeL_2);
              ); //190124to
              tmp="connect("+Textformat(Nk,10)+tmp3+");";//190125
              parse(tmp);
            );
            if((tmp1==1)%(tmp1==2),
              if(length(typeL)<4,typeL=append(typeL,1)); //
              if(typeL_(-1)!=1,
                tmp="linesize("+text(typeL_4)+")";
                parse(tmp);
              );
              tmp3=",dashtype->1"+tmp3;
              forall(1..(length(Nk)-1),
                tmp="draw("+Textformat([Nk_#,Nk_(#+1)],10)+tmp3+");";
                parse(tmp);
              );
              if(typeL_(-1)!=1,
                tmp="linesize(1)";
                parse(tmp);
              );  //
            );
            if(tmp1==3,
              if(typeL_3!=1,
                tmp="linesize("+text(typeL_3)+")";
                parse(tmp);
              );
              tmp3=",dashtype->3"+tmp3;
              forall(1..(length(Nk)-1),
                tmp="draw("+Textformat([Nk_#,Nk_(#+1)],10)+tmp3+");";
                parse(tmp);
              );
              if(typeL_3!=1,
                tmp="linesize(1)";
                parse(tmp);
              );
            );
          ,
            if(indexof(opcindy,"size")==0,  //190425from
              opcindy=opcindy+",size->"+text(TenSize/TenSizeInit);
            ); //190425to
            tmp="draw("+text(Nk_1)+opcindy+");"; 
            parse(tmp);
           ); //190126to
        );
      );
    );
  );
  forall(PTSHADElist, //200519from
    parse(#_2);
  ); //200519to

  grestore(); 
  layer(0);
);
Drwxy():=Drwxy(0,[]);
Drwxy(Arg):=( //190901from
  if(islist(Arg),
    Drwxy(0,Arg);
  ,
    Drwxy(Arg,[]);
  ); //190901to
);
Drwxy(add,optionsorg):=(
  regional(options,color,eqL,strL,org,xrng,yrng,ax,st,nn,size,labelsize,
  linesty,colorax,colorla,tmp,tmp1,tmp2);
  options=optionsorg;
  tmp=Divoptions(options);
  color=tmp_(length(tmp)-2);
  eqL=tmp_5;
  org=GENTEN; 
  xrng=[XMIN,XMAX];  //190103
  yrng=[YMIN,YMAX];  //190103
  ax=AXSTYLE_1; //190901from
  labelsize=1.5; //210408
  forall(AXSTYLE_2,
    tmp=Strsplit(#,"=");
    tmp1=Toupper(substring(tmp_1,0,1));
    if(contains(["S","L"],tmp1), 
      labelsize=parse(tmp_2);
      options=remove(options,[#]);
    );
  );  //190901to
  linesty=ax_8;
  if(length(ax_9)>0, //190427
    if(isstring(ax_9),colorax=ax_9,colorax=text(ax_9));
  ,
    colorax=KCOLOR; //190427
  );
  colorax="Color="+colorax; //190427[if removed]
  if(isstring(ax_10),colorla=ax_10,colorla=text(ax_10));
  if(length(colorla)>0, //181217from
    colorla="Color="+colorla;
  ,
    if(length(colorax)>0,
      colorla=colorax;
    );
  ); //181217to
  forall(eqL,
    if(tmp1=="O", //190103from
      org=parse(tmp_2);
      options=remove(options,[#]);
    );  //190103to
    if(tmp1=="X",
      xrng=parse(tmp_2);
      options=remove(options,[#]);
    );
    if(tmp1=="Y",
      yrng=parse(tmp_2);
      options=remove(options,[#]);
    );
    if(tmp1=="A",
      tmp2=tokenize(tmp_2,",");
      st=1; nn=1;
      if(isreal(tmp2_1),
        st=2;
        nn=tmp2_1;
      );
      forall(st..(length(tmp2)),
        tmp=tmp2_#;
        if(length(tmp)>0,ax_nn=tmp);
        nn=nn+1;
      );
      options=remove(options,[#]);
    );
  );
  options=append(options,linesty); //181216
  if(substring(ax_1,0,1)=="a",
    strL=select(options,isstring(#)); //181216
    tmp=select(strL,contains(["dr","da","do","id"],substring(#,0,2)));
    if(length(tmp)==0,options=append(options,YasenStyle));
    tmp=substring(ax_1,1,length(ax_1)); //181216[2lines]
    if(length(tmp)>0,size=parse(tmp),size=YaSize); 
    tmp1=concat(options,[size,YaAngle,YaPosition,YaCut,colorax]);//210425
    tmp=[[xrng_1,org_2],[xrng_2,org_2]];
    Arrowdataseg("axx"+text(AXCOUNT),tmp,tmp1);
    tmp=[[org_1,yrng_1],[org_1,yrng_2]];
    Arrowdataseg("axy"+text(AXCOUNT),tmp,tmp1); //190419
  ,
    tmp=[[xrng_1,org_2],[xrng_2,org_2]];
    tmp1=concat(options,[colorax,"Msg=n"]);//181216,190325
    Listplot("-axx"+text(AXCOUNT),tmp,tmp1); 
    tmp=[[org_1,yrng_1],[org_1,yrng_2]];
    Listplot("-axy"+text(AXCOUNT),tmp,tmp1); 
  );
  AXCOUNT=AXCOUNT+1;
  tmp=[colorla,"Size="+text(labelsize)]; ///210408
  Expr([[xrng_2,org_2],ax_3,ax_2],tmp); //210407from
  Expr([[org_1,yrng_2],ax_5,ax_4],tmp);
  Letter([org,ax_7,ax_6],tmp); //190901to //
  if(add==0, //190103
    Addax(0);
  );
);
Expr(Pt,Dr,St):=Expr([Pt,Dr,St]);
Expr(list):=Expr(list,[]);
Expr(Pt,Dr,St,options):=Expr([Pt,Dr,St],options); //190409
Expr(listorg,options):=( //16.10.09
  regional(list,str,tmp,tmp1,tmp2);
  list=listorg;
  forall(1..round(length(list)/3),
    str=list_(3*#);
    if(isstring(str), //200526from
      if(!iswindows(),
        str=replace(str,"¥","\");
      ); 
    ,
      str=format(str,10)
    ); //200526to
    str="$"+str+"$"; //200526
    list_(3*#)=str;
  );
  Letter(list,options);
);
Letter(Pt,Dr,St):=Letter([Pt,Dr,St]);
Letter(list):=Letter(list,[]);
Letter(Pt,Dr,St,options):=Letter([Pt,Dr,St],options);//181218
Letter(list,options):=(
  regional(Nj,Pos,Dir,Str,Off,Xmv,Ymv,Noflg,opcindy,
      opL,aln,sz,clr,bld,ita,tmp,tmp1,tmp2,color,color4,eqL);
  tmp=Divoptions(options);
  eqL=tmp_5; //190209
  Noflg=tmp_2;
  color=tmp_(length(tmp)-2); color4=Colorrgb2cmyk(color); //200618
  opL=select(options,indexof(#,"->")>0); //16.10.09from
  tmp=select(opL,indexof(#,"color"));
  sz=16; //210516
  bld=false;
  ita=false;
  aln="left";
  forall(opL,
    tmp=indexof(#,"->");
    tmp1=Removespace(substring(#,0,tmp-1));
    tmp2=substring(#,tmp+1,length(#));
    if(tmp1=="size",sz=parse(tmp2));
    if(tmp1=="color",clr=parse(tmp2));
    if(tmp1=="bold",bld=parse(tmp2));
    if(tmp1=="ita",ita=parse(tmp2));
  );//16.10.09to
  forall(eqL, //190209from
    tmp=Strsplit(#,"=");
    tmp1=Toupper(substring(tmp_1,0,1));
    if(tmp1=="S",
      sz=round(parse(tmp_2)*16); //210516
    );
  ); //190209to
  Nj=1;
  if(Ketcindyjsfigure>0,sz=round(sz*Ketcindyjsscale) ); // 
  while(Nj+2<=length(list),
    Pos=Lcrd(list_Nj);  //220814
    Dir=list_(Nj+1);
    Str=list_(Nj+2);
    if(!isstring(Str),Str=format(Str,10)); // 16.09.30,10.09
    tmp=replace(Str,".xy","");
    tmp=replace(tmp,".x","(1)");
    Str=replace(tmp,".y","(2)");
    Str=RSslash(Str); // 17.09.24
    Str=replace(Str,"`","'");//180303
    tmp=Dq+","+Dq+Str+Dq+")";
    if(Noflg<2,
      Off=[0,0];
      Xmv=0; Ymv=0;
      aln="mid"; //200530from
      if(indexof(Dir,"c")>0, Off_2=-0.3*sz);
      if(indexof(Dir,"n")>0,Off_2=0;Ymv=Lettermove("n",Dir)); //210601
      if(indexof(Dir,"s")>0, Off_2=-0.85*sz;Ymv=-Lettermove("s",Dir));
      if(indexof(Dir,"e")>0,
        aln="left";
        if(indexof(Dir,"n")+indexof(Dir,"s")==0,Off=[0,-0.3*sz]);
        Xmv=Lettermove("e",Dir);
      );
      if(indexof(Dir,"w")>0,
        aln="right";
        if(indexof(Dir,"n")+indexof(Dir,"s")==0,Off=[0,-0.4*sz]);
        Xmv=-Lettermove("w",Dir);
      );
      Str=list_(Nj+2);  //17.10.17
      Pos=Pos+[Xmv,Ymv]*MARKLEN;//210530to
      if(length(color)==4,color=Colorcmyk2rgb(color)); //200523
      tmp="drawtext("+format(Pcrd(Pos),10)+",offset->"+text(Off)+","+Dqq(Str)+","; 
      tmp1="size->sz,color->colornow,align->"+Dqq(aln)+",bold->"+bld+",italics->"+ita; //210601
      tmp1=Assign(tmp1,["sz",text(sz),"colornow",text(color),"aln",Dqq(aln),"bld",text(bld),"ita",text(ita)]);
      tmp=tmp+tmp1+");";
      GCLIST=append(GCLIST,[tmp,[6,0]]); //201004to
    );
    Nj=Nj+3;
  );
);
Removespace(str):=(
  regional(tmp,flg,out);
  tmp=length(str)+1;
  flg=0;
  forall(1..(length(str)),
    if(flg==0,
      if((str_#)!=" ",
        tmp=#;
        flg=1;
      );
    );
  );
  out=substring(str,tmp-1,length(str));
  flg=0;
  tmp=0;
  forall(reverse(1..(length(out))),
    if(flg==0,
      if((out_#)!=" ",
        tmp=#;
        flg=1;
      );
    );
  );
  out=substring(out,0,tmp);
);
Lettermove(dir,str):=(
  regional(Suu,tmp,tmp1,out,nn);
  Suu="+-.0123456789";
  tmp=indexof(str,dir);
  tmp1=substring(str,tmp,length(str));
  out="";
  nn=1;
  while(nn<=length(tmp1),
    tmp=substring(tmp1,nn-1,nn);
    if(indexof(Suu,tmp)>0,
      out=out+tmp;
    ,
      nn=length(str);
    );
    nn=nn+1;
  );
  if(length(out)==0,out=0,out=parse(out));
  out;
);
Dqq(str):=DqDq(str); //18.02.11
DqDq(str):=(
  unicode("0022")+str+unicode("0022");
);
Addax(param):=(
  ADDAXES=text(param);
);
Measuredepth(list):=( //190423
  regional(str,nn,tmp,tmp1,tmp2);
  str=text(list);
  tmp1=Indexall(str,"[");
  tmp2=select(tmp1,!contains(tmp1,#+1));
  nn=tmp2_1;
  tmp1=substring(str,nn,length(str));
  tmp=indexof(tmp1,",");
  tmp1=substring(tmp1,0,tmp-1);
  if(!ispoint(parse(tmp1)),
    nn=nn-1;
  );
  nn;
);
Indexall(str,key):=(
  regional(rest,out,flg,tmp,tmp1,);
  out=[];
  rest=str;
  flg=0;
  forall(1..(length(str)),
    if(flg==0,
      tmp=indexof(rest,key);
      if(tmp>0,
        tmp1=tmp+length(str)-length(rest);
        out=append(out,tmp1);
        rest=substring(rest,tmp,length(rest));
      ,
        flg=1;
      );
    );
  );
  out;
);
Ketcindyjsfigure=0;
Ketcindyjsscale=1;

;

</script><link rel="stylesheet" href="https://ktky.sakura.ne.jp/lib/CindyJS/katex/katex.min.css" media="all">

</head>


<body>

<div id="eps" style="">
<span class="">
<span class="admin" style="display: none;"><input type="checkbox" onclick="EPS.switch_admin_parent2(this); " checked="true"></span>
<button type="button" name="mode_menu_button" id="eps_mode_menu_botton" onclick="EPS.mode_menu(0)">èÆâüÉxLO</button></span>
<span class="" style="">
<span class="admin" style="display: none;"><input type="checkbox" onclick="EPS.switch_admin_parent2(this); " checked="true"></span>
<button type="button" name="save_botton" id="save_botton" onclick="EPS.save()" style="">ÝX</button></span>
<table id="eps_menu_table" class="eps_menu_table, admin" border="1" style="display: none;"><tbody><tr><th>_ý</th><th>M</th><th>4@</th><th>ª×·çó</th></tr>

<tr>
      <td>
<input type="button" value="login -š" class="insert_dom_userid_button" onclick="eps.insert_dom_userid_button(this);">
      </td>
       <td>
      </td>
       <td>
<input type="text" class="insert_dom_userid_place" value="eps_basis" size="5">
<select class="insert_dom_userid_beforeafter">
<option value="after">nŒ</option>
<option value="before">nM</option>
</select>
      </td>
       <td>
<select class="insert_dom_userid_localsession">
<option value="local">local</option>
<option value="session">session</option>
</select>
      </td>
    </tr>

<tr>
      <td>
<input type="button" value="radio button ý " class="insert_dom_radio_button" onclick="eps.insert_dom_radio_button(this);">
      </td>
       <td>
<input type="text" class="insert_dom_radio_name" value="r1" size="5">
      </td>
       <td>
<input type="text" class="insert_dom_radio_place" value="eps_basis" size="5">
<select class="insert_dom_radio_beforeafter">
<option value="after">nŒ</option>
<option value="before">nM</option>
</select>
      </td>
       <td>
xž¢: <input type="text" class="insert_dom_radio_selections" value="A,B,C">
      </td>
    </tr>


<tr>
      <td>
<input type="button" value="textarea ý " class="insert_dom_textarea_button" onclick="eps.insert_dom_textarea_button(this);">
      </td>
       <td>
<input type="text" class="insert_dom_textarea_name" value="t1" size="5">
      </td>
       <td>
<input type="text" class="insert_dom_textarea_place" value="eps_basis" size="5">
<select class="insert_dom_textarea_beforeafter">
<option value="after">nŒ</option>
<option value="before">nM</option>
</select>
      </td>
       <td>
Lp: <input type="text" class="insert_dom_textarea_row" size="5" value="10">
p: <input type="text" class="insert_dom_textarea_column" size="5" value="80">
      </td>
    </tr>


<tr>
      <td>
<input type="button" value="Cinderella ý " class="insert_dom_cinderella_button" onclick="eps.insert_dom_cinderella_button(this);">
      </td>
       <td>
<input type="text" class="insert_dom_cinderella_name" value="c1" size="5">
      </td>
       <td>
<input type="text" class="insert_dom_cinderella_place" value="eps_basis" size="5">
<select class="insert_dom_cinderella_beforeafter">
<option value="after">nŒ</option>
<option value="before">nM</option>
</select>
      </td>
       <td>
      </td>
    </tr>


<tr>
      <td>
<input type="button" value="Quill ý " class="insert_dom_quill_button" onclick="eps.insert_dom_quill_button(this);">
      </td>
       <td>
<input type="text" class="insert_dom_quill_name" value="q1" size="5">
      </td>
       <td>
<input type="text" class="insert_dom_quill_place" value="eps_basis" size="5">
<select class="insert_dom_quill_beforeafter">
<option value="after">nŒ</option>
<option value="before">nM</option>
</select>
      </td>
       <td>
      </td>
    </tr>


<tr>
      <td>
<input type="button" value="Javascript Ü¿ó ý " class="insert_dom_j_button_button" onclick="eps.insert_dom_j_button_button(this);">
      </td>
       <td>
<input type="text" class="insert_dom_j_button_name" value="j1" size="5">
      </td>
       <td>
<input type="text" class="insert_dom_j_button_place" value="eps_basis" size="5">
<select class="insert_dom_j_button_beforeafter">
<option value="after">nŒ</option>
<option value="before">nM</option>
</select>
      </td>
       <td>
label: <input type="text" class="insert_dom_j_button_label" size="10" value="ŸL">
Lp: <input type="text" class="insert_dom_j_button_row" size="10" value="10">
p: <input type="text" class="insert_dom_j_button_column" size="10" value="80">
      </td>
</tr>

<tr>
      <td>
<input type="button" value="Chart ý " class="insert_dom_chart_button" onclick="eps.insert_dom_chart_button(this);">
      </td>
       <td>
<input type="text" class="insert_dom_chart_name" value="g1" size="5">
      </td>
       <td>
<input type="text" class="insert_dom_chart_place" value="eps_basis" size="5">
<select class="insert_dom_chart_beforeafter">
<option value="after">nŒ</option>
<option value="before">nM</option>
</select>
      </td>
       <td>
label1: <input type="text" class="insert_dom_chart_label1" size="10" value="°éÕÏ;">
Çü¿b: <select class="insert_dom_chart_dataformat">
<option value="textarea">textarea</option>
<option value="jspreadsheet">jspreadsheet</option>
</select>
      </td>
</tr>

<tr>
      <td>
<input type="button" value="h— ý " class="insert_dom_spread_button" onclick="eps.insert_dom_spread_button(this);">
      </td>
       <td>
<input type="text" class="insert_dom_spread_name" value="s1" size="5">
      </td>
       <td>
<input type="text" class="insert_dom_spread_place" value="eps_basis" size="5">
<select class="insert_dom_spread_beforeafter">
<option value="after">nŒ</option>
<option value="before">nM</option>
</select>
      </td>
       <td>
label1: <input type="text" class="insert_dom_spread_label1" size="10" value="h—">
label2: <input type="text" class="insert_dom_spread_label2" size="10" value="À¦óíüÉ">
label3: <input type="text" class="insert_dom_spread_label3" size="10" value="csvú›">
      </td>
</tr>

<tr>
      <td>
<input type="button" value="Õ¡¤ëeú› ý " class="insert_dom_fileinoutput_button" onclick="eps.insert_dom_fileinoutput_button(this);">
      </td>
       <td>
<input type="text" class="insert_dom_fileinoutput_name" value="g1" size="5">
      </td>
       <td>
<input type="text" class="insert_dom_fileinoutput_place" value="eps_basis" size="5">
<select class="insert_dom_fileinoutput_beforeafter">
<option value="after">nŒ</option>
<option value="before">nM</option>
</select>
      </td>
       <td>
      </td>
</tr>

<tr>
      <td>
<input type="button" value=";bq	 ý " class="insert_dom_displayshare_button" onclick="eps.insert_dom_displayshare_button(this);">
      </td>
       <td>
<input type="text" class="insert_dom_displayshare_name" value="d1" size="5">
      </td>
       <td>
<input type="text" class="insert_dom_displayshare_place" value="eps_basis" size="5">
<select class="insert_dom_displayshare_beforeafter">
<option value="after">nŒ</option>
<option value="before">nM</option>
</select>
      </td>
       <td>
<select class="insert_dom_displayshare_sendrecv">
<option value="send">á</option>
<option value="recv">×á</option>
</select>
      </td>
</tr>

<tr>
      <td>
<input type="button" value="TVûq ý " class="insert_dom_TVphone_button" onclick="eps.insert_dom_TVphone_button(this);">
      </td>
       <td>
<input type="text" class="insert_dom_TVphone_name" value="t1" size="5">
      </td>
       <td>
<input type="text" class="insert_dom_TVphone_place" value="eps_basis" size="5">
<select class="insert_dom_TVphone_beforeafter">
<option value="after">nŒ</option>
<option value="before">nM</option>
</select>
      </td>
       <td>
<select class="insert_dom_TVphone_sendrecv">
<option value="sendrecv">×á</option>
<option value="send">á</option>
<option value="recv">×á</option>
</select>
      </td>
</tr>

<tr>
      <td>
<input type="button" value="P2PÇü¿ ý " class="insert_dom_DataEx_button" onclick="eps.insert_dom_DataEx_button(this);">
      </td>
       <td>
<input type="text" class="insert_dom_DataEx_name" value="d1" size="5">
      </td>
       <td>
<input type="text" class="insert_dom_DataEx_place" value="eps_basis" size="5">
<select class="insert_dom_DataEx_beforeafter">
<option value="after">nŒ</option>
<option value="before">nM</option>
</select>
      </td>
       <td>
<select class="insert_dom_DataEx_recv">
<option value="textarea">Æ­¹È¨ê¢</option>
<option value="exec">ŸL</option>
</select>
      </td>
</tr>

      <tr><td>
<input type="button" value="Jd" class="delete_dom_button" onclick="eps.delete_dom_button(this);">
      </td>
       <td>
<input type="text" class="delete_dom_name" value="test1" size="5">
      </td>
       <td>
      </td>
       <td>
      </td>
    </tr>
</tbody></table>
<div id="eps_basis" class="admin" style="display: none;">
<span class="admin" style="display: none;"><input type="checkbox" onclick="EPS.switch_admin_parent2(this); "></span>
(eps_basis):</div><div id="c1" class="cinderella_box" idx="0">
<span class="admin" style="display: none;">
<span class="admin" style="display: none;"><input type="checkbox" onclick="EPS.switch_admin_parent2(this); "></span>
(c1):</span>
<span class="admin" style="display: none;">
<span class="admin" style="display: none;"><input type="checkbox" onclick="EPS.switch_admin_parent2(this); "></span>
<input type="file" idx="0" class="cinderella_pic" style=""><br></span>
<span class="">
<span class="admin" style="display: none;"><input type="checkbox" onclick="EPS.switch_admin_parent2(this); " checked="true"></span>
<div id="CSCanvas_0" class="CindyJS-widget" style="position: relative; width: 793px; height: 550px;"><canvas width="991" style="position: absolute; border: none; top: 0px; left: 0px; padding: 0px; margin: 0px; height: 100%; width: 100%; background-color: rgb(247, 247, 247);" height="687"></canvas><div class="CindyJS-baseline" style="left: 226.716px; top: 523.874px;"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAPoCAQAAAC1v1zVAAAAGklEQVR42u3BMQEAAADCoPVPbQ0PoAAAgHcDC7gAAVI8ZnwAAAAASUVORK5CYII="><div class="CindyJS-button"><button style="background-color: rgba(255, 187, 119, 0.514); color: rgb(0, 0, 0); font: 18px / 1.45 sans-serif;">Play</button></div></div><div class="CindyJS-baseline" style="left: 297.508px; top: 523.874px;"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAPoCAQAAAC1v1zVAAAAGklEQVR42u3BMQEAAADCoPVPbQ0PoAAAgHcDC7gAAVI8ZnwAAAAASUVORK5CYII="><div class="CindyJS-button"><button style="background-color: rgba(255, 187, 119, 0.52); color: rgb(0, 0, 0); font: 18px / 1.45 sans-serif;">Pause</button></div></div><div class="CindyJS-baseline" style="left: 391.098px; top: 525.074px;"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAPoCAQAAAC1v1zVAAAAGklEQVR42u3BMQEAAADCoPVPbQ0PoAAAgHcDC7gAAVI8ZnwAAAAASUVORK5CYII="><div class="CindyJS-button"><button style="background-color: rgba(255, 187, 119, 0.47); color: rgb(0, 0, 0); font: 18px / 1.45 sans-serif;">Rev</button></div></div><div class="CindyJS-baseline" style="left: 459.731px; top: 526.033px;"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAPoCAQAAAC1v1zVAAAAGklEQVR42u3BMQEAAADCoPVPbQ0PoAAAgHcDC7gAAVI8ZnwAAAAASUVORK5CYII="><div class="CindyJS-button"><button style="background-color: rgba(255, 187, 119, 0.565); color: rgb(0, 0, 0); font: 18px / 1.45 sans-serif;">Stop</button></div></div><div style="position: absolute; transition: 0s; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;"><div style="position: absolute; transition: 0s; left: 0; top: 0; width: 100000px; height: 100000px"></div></div><div style="position: absolute; transition: 0s; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;"><div style="position: absolute; transition: 0s; left: 0; top: 0; width: 200%; height: 200%"></div></div></div></span></div><div id="draw" class="ict_textarea" idx="1">
<span class="">
<span class="admin" style="display: none;"><input type="checkbox" onclick="EPS.switch_admin_parent2(this); " checked="true"></span>
(draw):<br></span>
<span class="">
<span class="admin" style="display: none;"><input type="checkbox" onclick="EPS.switch_admin_parent2(this); " checked="true"></span>
<textarea id="ict_textarea_1" rows="10" cols="80" style="width: 634px; height: 382px;"></textarea></span></div><div id="move" class="ict_textarea" idx="0">
<span class="admin" style="display: none;">
<span class="admin" style="display: none;"><input type="checkbox" onclick="EPS.switch_admin_parent2(this); "></span>
(move):<br></span>
<span class="admin" style="display: none;">
<span class="admin" style="display: none;"><input type="checkbox" onclick="EPS.switch_admin_parent2(this); "></span>
<textarea id="ict_textarea_0" rows="10" cols="80"></textarea></span></div><div id="j1" class="j_textarea" idx="0">
<span class="admin" style="display: none;">
<span class="admin" style="display: none;"><input type="checkbox" onclick="EPS.switch_admin_parent2(this); "></span>
(j1):<br></span>
<span class="admin" style="display: none;">
<span class="admin" style="display: none;"><input type="checkbox" onclick="EPS.switch_admin_parent2(this); "></span>
<textarea id="j_textarea_0" rows="3" cols="80"></textarea>
</span>
<span class="">
<span class="admin" style="display: none;"><input type="checkbox" onclick="EPS.switch_admin_parent2(this); " checked="true"></span>
<input type="button" id="j_button_0" value="ŸL" onclick="eps.j_button_exec_this(this);"></span></div>

<script>

  var eps = new EPS('eps','eps');

</script>

<script>

/*
const signalingUrl = 'wss://ayame-labo.shiguredo.jp/signaling';
let roomId = 'ayame-web-sdk-sample';
let clientId = null;
let videoCodec = null;
let audioCodec = null;
let signalingKey = null;

// query string K‰ roomId, clientId ’Ö—Y‹ØëÑü
function parseQueryString() {
  const qs = window.Qs;
  if (window.location.search.length > 0) {
    var params = qs.parse(window.location.search.substr(1));
    if (params.roomId) {
      roomId = params.roomId;
    }
    if (params.clientId) {
      clientId = params.clientId;
    }
    if (params.signalingKey) {
      signalingKey = params.signalingKey;
    }
  }
}

parseQueryString();

const roomIdInput = document.getElementById("roomIdInput");
roomIdInput.addEventListener('change', (event) => {
  console.log(event);
  roomId = event.target.value;
});

        const options = Ayame.defaultOptions;
        options.clientId = clientId ? clientId : options.clientId;
        if (signalingKey) {
          options.signalingKey = signalingKey;
        }
        options.audio.enabled = false;
        options.video.direction = 'sendonly';
        options.audio.direction = 'sendonly';
        var conn = new Array();
        
        document.querySelector("#roomIdInput").value = roomId;
        document.querySelector("#clientIdInput").value = options.clientId;
        
async function startConn() {
          conn[0] = Ayame.connection(signalingUrl, roomId, options, true);
          const mediaStream = await navigator.mediaDevices.getDisplayMedia({video: true});
          console.log('connect 1');
          await conn[0].connect(mediaStream, null);
          console.log('connect 2');
}

function disconnect() {

          if (conn[0]) {
            conn[0].disconnect();
          }
}

async function startConn2() {
          conn[0] = Ayame.connection(signalingUrl, roomId, options, true);
          const mediaStream = await navigator.mediaDevices.getDisplayMedia({video: true});
          console.log('connect 1');
          await conn[0].connect(mediaStream, null);
          console.log('connect 2');
}

function disconnect2() {

          if (conn[0]) {
            conn[0].disconnect();
          }
}
*/

</script>


</div>











<div class="admin">(init:)<br><textarea id="eps_init_textarea" rows="10" cols="80">document.getElementById("ict_textarea_1").value = `Ketinit();
Setketcindyjs(["Label=[]","Color=offwhite"]);//no ketjs

pO=[0,0];
Circledata("1",[pO,5],["dr,70","Color=black"]);
Circledata("2",[pO,4],["dr,70","Color=yellow"]);



ss=Animationparam(0,2*pi/3,2*pi);

if(ss&gt;pi/4,
  Circledata("1",[pO,5],["dr,70","Color=yellow"]);
);
  if(ss&gt;pi/4,
    Circledata("2",[pO,4],["dr,70","Color=black"]);
  );
if(ss&gt;pi/2,
  Circledata("1",[pO,5],["dr,70","Color=black"]);
);
  if(ss&gt;pi/2,
    Circledata("2",[pO,4],["dr,70","Color=yellow"]);
  );

if(ss&gt;pi*3/4,
  Circledata("1",[pO,5],["dr,70","Color=yellow"]);
);
  if(ss&gt;pi*3/4,
    Circledata("2",[pO,4],["dr,70","Color=black"]);
  );
if(ss&gt;pi,
  Circledata("1",[pO,5],["dr,70","Color=black"]);
);
  if(ss&gt;pi,
    Circledata("2",[pO,4],["dr,70","Color=yellow"]);
  );

if(ss&gt;5/4*pi,
  Circledata("1",[pO,5],["dr,70","Color=yellow"]);
);
  if(ss&gt;5/4*pi,
    Circledata("2",[pO,4],["dr,70","Color=black"]);
  );
if(ss&gt;6/4*pi,
  Circledata("1",[pO,5],["dr,70","Color=black"]);
);
  if(ss&gt;6/4*pi,
    Circledata("2",[pO,4],["dr,70","Color=yellow"]);
  );
if(ss&gt;7/4*pi,
  Circledata("1",[pO,5],["dr,70","Color=yellow"]);
);
  if(ss&gt;7/4*pi,
    Circledata("2",[pO,4],["dr,70","Color=black"]);
  );

Arrowdata("1",[[0,0],3.2*[sin(1*ss),cos(1*ss)]],["dr,7",7]);



Windispg();`;
document.getElementById("ict_textarea_0").value = ``;
document.getElementById("j_textarea_0").value = `EPS.textarea_to_csdiv("draw","csdraw");
EPS.textarea_to_csdiv("move","csmove");
EPS.restart_cs("c1");`;

EPS.cinderella_code[0] = `
EPS.cinderella_obj[0] = CindyJS({
  scripts: "cs*",
  use: ["katex"],
  defaultAppearance: {
    dimDependent: 0.7,
    fontFamily: "sans-serif",
    lineSize: 1,
    pointSize: 5.0,
    textsize: 12.0
  },
  angleUnit: "°",
  geometry: [
    {name: "SW", type: "Free", pos: [4.0, 4.0, -0.8], color: [1.0,1.0,1.0], labeled: false, size: 2.0, border:false },
    {name: "NE", type: "Free", pos: [4.0, 4.0, 0.8], color: [1.0,1.0,1.0], labeled: false, size: 2.0, border:false },
    {name: "Text71", type: "Button", pos: [-2.3961352657004826, -4.0, 0.6408495487541914], color: [0.0, 0.0, 0.0], fillcolor: [1.0, 0.737, 0.467], fillalpha: 0.5128205128205128, script: 'resetclock(); playanimation(); Animeflg=1; Dirflg=1; sorg=Current; ', text: "Play", textsize: 18.0},
    {name: "Text72", type: "Button", pos: [-1.2560386473429952, -4.0, 0.6408495487541914], color: [0.0, 0.0, 0.0], fillcolor: [1.0, 0.737, 0.467], fillalpha: 0.5213675213675214, script: 'Animeflg=1-Animeflg; if(Animeflg==0,   pauseanimation();   sorg=sstart; ,   resetclock();   playanimation(); ); ', text: "Pause", textsize: 18.0},
    {name: "Text73", type: "Button", pos: [0.25, -4.0, 0.6377685413082578], color: [0.0, 0.0, 0.0], fillcolor: [1.0, 0.737, 0.467], fillalpha: 0.4700854700854701, script: 'sorg=sstart; Dirflg=-Dirflg; Animeflg=1; resetclock(); playanimation(); ', text: "Rev", textsize: 18.0},
    {name: "Text74", type: "Button", pos: [1.344827586206896, -4.0, 0.6353249836787246], color: [0.0, 0.0, 0.0], fillcolor: [1.0, 0.737, 0.467], fillalpha: 0.5641025641025641, script: 'stopanimation(); Animeflg=""; sstart=Current; ', text: "Stop", textsize: 18.0}
  ],
  ports: [{
    id: "CSCanvas_0",
    width: 793,
    height: 550,
    transform: [{visibleRect: [-9.436441031706003, 6.923407468002673, 10.491915128461402, -6.89827713236564]}],
    axes: true,
    grid: 0.5,
    background: "rgb(247,247,247)"
  }],
  csconsole: false,
  cinderella: {build: 2058, version: [3, 0, 2058]}
});
    ;`;
EPS.cinderella_code[0] = EPS.cinderella_code[0].replace(/YENMARKSYMBOL/g,"\\").replace(/DASHSYMBOL/g,`'+"'"+'`);
eval(EPS.cinderella_code[0]);

var elements = document.getElementsByClassName( "cinderella_pic" ) ;
var ei,num,i;
for (i=0;i&lt;elements.length; i++) {
  ei = elements[i];
  ei.onchange = function () {
    var fileReader = new FileReader() ;
    var num = this.getAttribute("idx");
    fileReader.onload = function () {
      EPS.cutcindycom(this.result,num) ;
    }
			  
    var file = this.files[0] ;
    fileReader.readAsText( file );
  }
};

EPS.mode_menu(0);

</textarea></div>
</body></html>